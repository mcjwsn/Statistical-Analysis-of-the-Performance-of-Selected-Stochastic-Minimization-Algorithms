---
title: "Porównanie działania wybranych algorytmów minimalizacji stochastycznej"
author: "Kacper Feliks, Maciej Wiśniewski"
date: "2023-10-10"
output: pdf_document
---

# Cel projektu

Projekt polega na prostym opracowaniu statystycznym wyników porównania działania wybranych algorytmów minimalizacji stochastycznej. Zdecydowaliśmy się do porównania użyć następujących algorytmów:

#### - Poszukiwanie przypadkowe (Pure Random Search, PRS)

#### - Metoda wielokrotnego startu (multi-start, MS)

## Opis algorytmów

### Poszukiwanie przypadkowe (Pure Random Search, PRS)

Algorytm PRS polega na losowym przeszukiwaniu przestrzeni rozwiązań, w której minimalizowana funkcja jest zdefiniowana. Działa w następujący sposób:

1.  **Losowanie punktów**: Losujemy kolejne punkty w przestrzeni poszukiwań z rozkładu jednostajnego. Jeżeli dziedzina poszukiwań jest kostką wielowymiarową, to każdą współrzędną punktu losujemy z odpowiedniego jednowymiarowego rozkładu jednostajnego.\
    Na przykład, jeśli dziedzina poszukiwań to kostka trójwymiarowa $[0,1] \times [-2,2] \times [100,1000]$, losowanie współrzędnych wygląda następująco:

    -   pierwsza współrzędna: $U(0,1)$,
    -   druga współrzędna: $U(-2,2)$,
    -   trzecia współrzędna: $U(100,1000)$.

2.  **Porównanie wartości funkcji**: Wartość funkcji w każdym wylosowanym punkcie porównujemy z aktualnie zapamiętanym minimum. Jeśli wartość funkcji w nowym punkcie jest mniejsza, zapamiętujemy ten punkt jako nowe minimum.

3.  **Wynik**: Wartość funkcji w ostatnim zapamiętanym punkcie stanowi wynik algorytmu.

------------------------------------------------------------------------

### Metoda wielokrotnego startu (Multi-Start, MS)

Algorytm MS łączy losowe przeszukiwanie przestrzeni z metodami optymalizacji lokalnej. Jego kroki są następujące:

1.  **Losowanie punktów**: Podobnie jak w PRS, losujemy zadany zbiór punktów startowych z rozkładu jednostajnego w przestrzeni poszukiwań.

2.  **Uruchomienie optymalizacji lokalnej**: Dla każdego wylosowanego punktu startowego uruchamiana jest metoda optymalizacji lokalnej (np. metoda L-BFGS-B zaimplementowana w funkcji `optim()` w R).

3.  **Porównanie wyników**: Dla każdego startu zapisujemy wartość funkcji w zwróconym punkcie lokalnego minimum. Wynikiem algorytmu jest minimalna wartość funkcji spośród wszystkich punktów końcowych.

------------------------------------------------------------------------

Oba algorytmy można stosować w zadanej dziedzinie, różnią się jednak podejściem. PRS polega na losowym próbkowaniu całej przestrzeni, natomiast MS wykorzystuje optymalizację lokalną, aby dokładniej zbadać okolice losowo wybranych punktów startowych.

Do porównania należało wybrać dwie z funkcji dostępnych w pakiecie `smoof`, które są skalarne (single-objective) i mają wersje dla różnej liczby wymiarów (akceptują parametr `dimensions`).

W celu sprawdzenia dostępnych algorytmów wykonaliśmy następujący algorytm, który znajdywał dostępne funckje o podanych parametrach:

``` r
library(smoof)

scalar_dimensional_functions <- Filter(function(fn_name) {
  fn <- get(fn_name, envir = asNamespace('smoof'))
  is.function(fn) &&
  'dimensions' %in% names(formals(fn)) &&
  inherits(try(fn(2), silent = TRUE), 'smoof_function') &&
  getNumberOfObjectives(fn(2)) == 1
}, ls('package:smoof'))

print(scalar_dimensional_functions)
```

### Do porównania wybraliśmy dwie funckje:

-   Schwefel
-   Griewank

Nasz wybór padł dokładnie na te funkcje ze względu na nich odmienność, trudność w optymalizacji oraz niebanalną impelmentację.

## Specyfikacja sprzętu

Obliczenia i testy zostały wykonane na maszynie o następujące specyfikacji: - systemem Windows 10 - procesor Intel Core i7-6700HQ 2.60 GHz. - pamięć Ram 16Gb

# WYNIKI

```{r echo=FALSE}
a2ms <- as.vector(read.csv("./data/griewank2Dms.csv"))$x
a2prs <- as.vector(read.csv("./data/griewank2Dprs.csv"))$x
a10ms <- as.vector(read.csv("./data/griewank10Dms.csv"))$x
a10prs <- as.vector(read.csv("./data/griewank10Dprs.csv"))$x
a20ms <- as.vector(read.csv("./data/griewank20Dms.csv"))$x
a20prs <- as.vector(read.csv("./data/griewank20Dprs.csv"))$x
r2ms <- as.vector(read.csv("./data/schwefel2Dms.csv"))$x
r2prs <- as.vector(read.csv("./data/schwefel2Dprs.csv"))$x
r10ms <- as.vector(read.csv("./data/schwefel10Dms.csv"))$x
r10prs <- as.vector(read.csv("./data/schwefel10Dprs.csv"))$x
r20ms <- as.vector(read.csv("./data/schwefel20Dms.csv"))$x
r20prs <- as.vector(read.csv("./data/schwefel20Dprs.csv"))$x
```

## Funkcja Griewanka 2D

### MS

-   Średnia: `r mean(a2ms)`
-   Wartość najmniejsza: `r min(a2ms)`
-   Wartość największa: `r max(a2ms)`
-   Mediana: `r median(a2ms)`
-   Dolny kwartyl: `r quantile(a2ms, 0.25)`
-   Górny kwartyl: `r quantile(a2ms, 0.75)`

### PRS

-   Średnia: `r mean(a2prs)`
-   Wartość najmniejsza: `r min(a2prs)`
-   Wartość największa: `r max(a2prs)`
-   Mediana: `r median(a2prs)`
-   Dolny kwartyl: `r quantile(a2prs, 0.25)`
-   Górny kwartyl: `r quantile(a2prs, 0.75)`

## Funkcja Griewanka 10D

### MS

-   Średnia: `r mean(a10ms)`
-   Wartość najmniejsza: `r min(a10ms)`
-   Wartość największa: `r max(a10ms)`
-   Mediana: `r median(a10ms)`
-   Dolny kwartyl: `r quantile(a10ms, 0.25)`
-   Górny kwartyl: `r quantile(a10ms, 0.75)`

### PRS

-   Średnia: `r mean(a10prs)`
-   Wartość najmniejsza: `r min(a10prs)`
-   Wartość największa: `r max(a10prs)`
-   Mediana: `r median(a10prs)`
-   Dolny kwartyl: `r quantile(a10prs, 0.25)`
-   Górny kwartyl: `r quantile(a10prs, 0.75)`

## Funkcja Griewanka 20D

### MS

-   Średnia: `r mean(a20ms)`
-   Wartość najmniejsza: `r min(a20ms)`
-   Wartość największa: `r max(a20ms)`
-   Mediana: `r median(a20ms)`
-   Dolny kwartyl: `r quantile(a20ms, 0.25)`
-   Górny kwartyl: `r quantile(a20ms, 0.75)`

### PRS

-   Średnia: `r mean(a20prs)`
-   Wartość najmniejsza: `r min(a20prs)`
-   Wartość największa: `r max(a20prs)`
-   Mediana: `r median(a20prs)`
-   Dolny kwartyl: `r quantile(a20prs, 0.25)`
-   Górny kwartyl: `r quantile(a20prs, 0.75)`

## Funkcja Schwefela 2D

### MS

-   Średnia: `r mean(r2ms)`
-   Wartość najmniejsza: `r min(r2ms)`
-   Wartość największa: `r max(r2ms)`
-   Mediana: `r median(r2ms)`
-   Dolny kwartyl: `r quantile(r2ms, 0.25)`
-   Górny kwartyl: `r quantile(r2ms, 0.75)`

### PRS

-   Średnia: `r mean(r2prs)`
-   Wartość najmniejsza: `r min(r2prs)`
-   Wartość największa: `r max(r2prs)`
-   Mediana: `r median(r2prs)`
-   Dolny kwartyl: `r quantile(r2prs, 0.25)`
-   Górny kwartyl: `r quantile(r2prs, 0.75)`

## Funkcja Schwefela 10D

### MS

-   Średnia: `r mean(r10ms)`
-   Wartość najmniejsza: `r min(r10ms)`
-   Wartość największa: `r max(r10ms)`
-   Mediana: `r median(r10ms)`
-   Dolny kwartyl: `r quantile(r10ms, 0.25)`
-   Górny kwartyl: `r quantile(r10ms, 0.75)`

### PRS

-   Średnia: `r mean(r10prs)`
-   Wartość najmniejsza: `r min(r10prs)`
-   Wartość największa: `r max(r10prs)`
-   Mediana: `r median(r10prs)`
-   Dolny kwartyl: `r quantile(r10prs, 0.25)`
-   Górny kwartyl: `r quantile(r10prs, 0.75)`

## Funkcja Schwefela 20D

### MS

-   Średnia: `r mean(r20ms)`
-   Wartość najmniejsza: `r min(r20ms)`
-   Wartość największa: `r max(r20ms)`
-   Mediana: `r median(r20ms)`
-   Dolny kwartyl: `r quantile(r20ms, 0.25)`
-   Górny kwartyl: `r quantile(r20ms, 0.75)`

### PRS

-   Średnia: `r mean(r20prs)`
-   Wartość najmniejsza: `r min(r20prs)`
-   Wartość największa: `r max(r20prs)`
-   Mediana: `r median(r20prs)`
-   Dolny kwartyl: `r quantile(r20prs, 0.25)`
-   Górny kwartyl: `r quantile(r20prs, 0.75)`

## Kolejne histogramy

```{r echo=FALSE}
hist(a2ms, main="Funkcja Griewanka 2D, MS", 
     xlab = "Znaleziona wartość minimum", ylab = "Ilość wystąpień", labels = TRUE,
     ylim = c(0,70), xlim = c(0,5)
     )
```

```{r echo=FALSE}
hist(a2prs, main="Funkcja Griewanka 2D, PRS", 
     xlab = "Znaleziona wartość minimum", ylab = "Ilość wystąpień", labels = TRUE,
     ylim = c(0,30), xlim = c(0,2)
     )
```

```{r echo=FALSE}
hist(a10ms, main="Funkcja Griewanka 10D, MS", 
     xlab = "Znaleziona wartość minimum", ylab = "Ilość wystąpień", labels = TRUE,
     xlim = c(0, 2.5e-10),  # Dostosowanie zakresu osi X
     ylim = c(0, 40),  # Dostosowanie zakresu osi Y
     )
```

```{r echo=FALSE}
hist(a10prs, main="Funkcja Griewanka 10D, PRS", 
     xlab = "Znaleziona wartość minimum", ylab = "Ilość wystąpień", labels = TRUE,
     xlim = c(10, 100),  # Dostosowanie zakresu osi X
     ylim = c(0, 30),  # Dostosowanie zakresu osi Y
     )
```

```{r echo=FALSE}
hist(a20ms, main="Funkcja Griewanka 20D, MS", 
     xlab = "Znaleziona wartość minimum", ylab = "Ilość wystąpień", labels = TRUE,
     xlim = c(0, 2e-10),  # Dostosowanie zakresu osi X
     ylim = c(0, 25),
     )
```

```{r echo=FALSE}
hist(a20prs, main="Funkcja Griewanka 20D, PRS", 
     xlab = "Znaleziona wartość minimum", ylab = "Ilość wystąpień", labels = TRUE,
     xlim = c(100, 300),  # Dostosowanie zakresu osi X
     ylim = c(0, 36),
     )
```

```{r echo=FALSE}
hist(r2ms, main="Funkcja Schwefela 2D, MS", 
     xlab = "Znaleziona wartość minimum", ylab = "Ilość wystąpień", labels = TRUE,
     xlim = c(-840,-700), ylim = c(0,103)
     )
```

```{r echo=FALSE}
hist(r2prs, main="Funkcja Schwefela 2D, PRS", 
     xlab = "Znaleziona wartość minimum", ylab = "Ilość wystąpień", labels = TRUE,
     ylim = c(0,35), xlim = c(-850,-600)
     )
```

```{r echo=FALSE}
hist(r10ms, main="Funkcja Schwefela 10D, MS", 
     xlab = "Znaleziona wartość minimum", ylab = "Ilość wystąpień", labels = TRUE,
     ylim = c(0,26), xlim = c(-3800,-2800)
     )
```

```{r echo=FALSE}
hist(r10prs, main="Funkcja Schwefela 10D, PRS", 
     xlab = "Znaleziona wartość minimum", ylab = "Ilość wystąpień", labels = TRUE,
     xlim = c(-2800,-1600), ylim = c(0,30)
     )
```

```{r echo=FALSE}
hist(r20ms, main="Funkcja Schwefela 20D, MS", 
     xlab = "Znaleziona wartość minimum", ylab = "Ilość wystąpień", labels = TRUE,
     xlim = c(-6800,-5400),ylim = c(0,30)
     )
```

```{r echo=FALSE}
hist(r20prs, main="Funkcja Schwefela 20D, PRS", 
     xlab = "Znaleziona wartość minimum", ylab = "Ilość wystąpień", labels = TRUE,
     xlim = c(-4000,-2000), ylim = c(0,35)
     )
```

# Wykresy pudełkowe

```{r echo=FALSE}
boxplot(a2ms,a2prs, main = "Funkcja Griewanka, 2D", names = c("MS", "PRS"), ylab = "Wartość")
boxplot(a10ms,a10prs, main = "Funkcja Griewanka, 10D", names = c("MS", "PRS"), ylab = "Wartość")
boxplot(a20ms,a20prs, main = "Funkcja Griewanka, 20D", names = c("MS", "PRS"), ylab = "Wartość")
boxplot(r2ms,r2prs, main = "Funkcja Schwefela, 2D", names = c("MS", "PRS"), ylab = "Wartość")
boxplot(r10ms,r10prs, main = "Funkcja Schwefela, 10D", names = c("MS", "PRS"), ylab = "Wartość")
boxplot(r20ms,r20prs, main = "Funkcja Schwefela, 20D", names = c("MS", "PRS"), ylab = "Wartość")
```

## T testy

Dla hipotezy zerowej twierdzącej, że średnie są sobie równe

#### Funkcja Griewanka, 2D

```{r echo=FALSE}
t.test(x = a2prs, y = a2ms, paired = TRUE)
```

#### Funkcja Griewanka, 10D

```{r echo=FALSE}
t.test(x = a10prs, y = a10ms, paired = TRUE)
```

#### Funkcja Griewanka, 20D

```{r echo=FALSE}
t.test(x = a20prs, y = a20ms, paired = TRUE)
```

#### Funkcja Schwefela, 2D

```{r echo=FALSE}
t.test(x = r2prs, y = r2ms, paired = TRUE)
```

#### Funkcja Schwefela, 10D

```{r echo=FALSE}
t.test(x = r10prs, y = r10ms, paired = TRUE)
```

#### Funkcja Schwefela, 20D

```{r echo=FALSE}
t.test(x = r20prs, y = r20ms, paired = TRUE)
```

### Wniosek:
raise("Unimplemented")
